# 贝壳网成交数据爬虫

这是一个用Rust编写的贝壳网成交数据爬虫，可以爬取贝壳网网站的成交数据，包括标题、成交价、挂牌价、成交日期、装修情况和成交周期等信息。帮助你快速成为房奴

## 功能特点

- 🔍 支持爬取链家成交数据
- 📊 自动提取关键信息：标题、价格、日期、装修情况等
- 📄 支持多页批量爬取
- 💾 数据保存为JSON和CSV格式
- 📈 提供数据统计分析
- 🛡️ 内置反爬虫检测和延迟机制
- 🔄 自动处理人机验证

## 安装和运行

### 环境要求

- Rust 1.70+
- 网络连接

### 安装依赖

```bash
cargo build
```

### 运行爬虫

```bash
cargo run
```

## 数据字段说明

爬取的数据包含以下字段：

| 字段名 | 说明 | 示例 |
|--------|------|------|
| title | 房源标题 | "大竹林 2室1厅 精装修" |
| deal_price | 成交价 | "180万" |
| list_price | 挂牌价 | "185万" |
| deal_date | 成交日期 | "2024-01-15" |
| is_renovated | 装修情况 | "精装"/"简装"/"毛坯" |
| deal_cycle | 成交周期 | "30天" |

## 输出文件

程序运行后会生成以下文件：

- `chengjiao_data.json` - JSON格式的完整数据
- `chengjiao_data.csv` - CSV格式的数据，方便在Excel中查看

## 配置说明

### Cookie配置

程序中使用的是你提供的cookie，包含登录状态和认证信息。如果cookie过期，需要更新main.rs中的cookie字符串。

### 爬取范围

默认爬取前3页数据，可以在main.rs中修改：

```rust
let start_page = 1;
let end_page = 3; // 修改这个数字来爬取更多页
```

### 延迟设置

为了避免被反爬虫机制检测，程序在每次请求之间会等待2秒。可以在`chengjiao.rs`中调整：

```rust
tokio::time::sleep(tokio::time::Duration::from_secs(2)).await;
```

## 注意事项

1. **Cookie有效期**：提供的cookie可能会过期，需要定期更新
2. **反爬虫机制**：贝壳网网站有反爬虫机制，如果遇到人机验证，程序会自动等待并重试
3. **页面结构变化**：如果链家网站页面结构发生变化，可能需要更新CSS选择器
4. **使用频率**：建议不要过于频繁地运行爬虫，避免IP被封

## 错误处理

程序包含以下错误处理机制：

- 网络连接错误
- 页面解析错误
- 人机验证检测
- 数据格式错误

## 依赖包

- `reqwest` - HTTP客户端
- `tokio` - 异步运行时
- `serde` - 序列化/反序列化
- `scraper` - HTML解析
- `anyhow` - 错误处理

## 许可证

MIT License

## 免责声明

本工具仅供学习和研究使用，请遵守相关网站的使用条款和robots.txt规定。使用者需要自行承担使用风险，开发者不承担任何法律责任。